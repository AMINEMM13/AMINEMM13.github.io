<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>VideoApp 다운로드</title>
</head>
<body>
  <h1>VideoApp 설치 및 실행</h1>

  <!-- 1. 설치 안내 -->
  <p>먼저 아래 버튼을 눌러 VideoApp을 다운로드하고,</p>
  <p><strong>다운로드한 exe 파일을 실행</strong>하세요.</p>
  <a href="https://drive.google.com/uc?export=download&id=10dMkvU8wIZznYfZZ3wPJnHkyeABNt-Bu">
    <button>앱 설치</button>
  </a>

  <hr>

  <!-- 2. 로컬 실행 후 업로드 기능 -->
  <div id="upload-section" style="display:none;">
    <h2>업로드 및 진행</h2>
    <form id="uploadForm" enctype="multipart/form-data">
      <!-- 기존 폼 그대로 -->
      <label>텍스트 파일 (.txt)</label>
      <input type="file" id="textfile" name="textfile" accept=".txt"><br>
      <label>이미지 파일</label>
      <input type="file" id="images" name="images" multiple><br>
      <label>웃음소리 넣기</label>
      <input type="radio" name="laugh" value="1">예
      <input type="radio" name="laugh" value="2" checked>아니오<br>
      <button type="submit">실행</button>
    </form>
    <div id="progress"><p>0% 진행 중…</p></div>
  </div>

  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    const uploadSection = document.getElementById('upload-section');

    // 1) "실행" 폼 보이게 할 조건: 로컬 서버가 살아 있을 때만
    async function checkLocalServer() {
      try {
        await axios.get('http://localhost:8329/');
        return true;
      } catch {
        return false;
      }
    }

    // 2) 페이지 로드시 바로 실행하지 않고…
    window.onload = async function() {
      // "실행" 섹션은 설치 후 로컬에서 접근해야 보이도록
      if (await checkLocalServer()) {
        uploadSection.style.display = 'block';
      }
    };

    // 3) 폼 제출 핸들러는 그대로…
    document.getElementById('uploadForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      /* 기존 axios POST + EventSource 로직 */
    });
  </script>
</body>
</html>
